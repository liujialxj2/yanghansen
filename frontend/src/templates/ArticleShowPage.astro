---
import { t } from "i18next";
import AposArea from '@apostrophecms/apostrophe-astro/components/AposArea.astro';
import dayjs from 'dayjs';

const { aposData } = Astro.props;
const { page, piece } = aposData;
const { content } = piece;
---

<div class="article-show-page">
  <section class="article-header">
    <div class="container">
      <div class="article-meta">
        <span class="article-date">
          {t("article.publishedOn")} {dayjs(piece.publicationDate).format('YYYY-MM-DD')}
        </span>
        {piece.authorName && (
          <span class="article-author">
            {t("article.author")}: {piece.authorName}
          </span>
        )}
      </div>
      
      <h1 class="title is-1">{piece.title}</h1>
      
      {piece.subtitle && (
        <h2 class="subtitle is-4">{piece.subtitle}</h2>
      )}
    </div>
  </section>
  
  {piece.thumbnail && (
    <section class="article-featured-image">
      <div class="container">
        <figure class="image">
          <img 
            src={piece.thumbnail._url} 
            alt={piece.title} 
            loading="eager"
          />
        </figure>
      </div>
    </section>
  )}
  
  <section class="section article-content">
    <div class="container">
      <div class="columns">
        <div class="column is-8 is-offset-2">
          <div class="content">
            <AposArea area={content} />
          </div>
          
          <div class="article-footer">
            <div class="tags">
              {piece.tags && piece.tags.map(tag => (
                <a href={`/articles?tag=${tag}`} class="tag is-medium">
                  {tag}
                </a>
              ))}
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>
</div>

<style>
  .article-header {
    padding: 5rem 1.5rem 3rem;
    background-color: #101010;
  }
  
  .article-meta {
    display: flex;
    flex-wrap: wrap;
    gap: 1rem;
    margin-bottom: 1.5rem;
    color: #888;
  }
  
  .article-date {
    color: #E03A3E;
  }
  
  .article-featured-image {
    margin-bottom: 2rem;
    background-color: #101010;
  }
  
  .article-featured-image .container {
    max-width: 1024px;
  }
  
  .article-featured-image img {
    width: 100%;
    height: auto;
    max-height: 500px;
    object-fit: cover;
  }
  
  .article-content {
    padding-top: 3rem;
  }
  
  .article-content .content {
    font-size: 1.125rem;
    line-height: 1.8;
  }
  
  .article-footer {
    margin-top: 3rem;
    padding-top: 2rem;
    border-top: 1px solid rgba(255, 255, 255, 0.1);
  }
  
  .tags {
    display: flex;
    flex-wrap: wrap;
    gap: 0.5rem;
  }
  
  .tag {
    background-color: rgba(255, 255, 255, 0.1);
    color: #f5f5f5;
    transition: background-color 0.2s ease;
  }
  
  .tag:hover {
    background-color: #E03A3E;
    color: white;
  }
</style>